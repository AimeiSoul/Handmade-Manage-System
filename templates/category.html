{% extends "base.html" %}

{% block content %}
    <h1 style="text-align: center;">
        {% if category == 'knitting' %}针织类{% else %}手工类{% endif %}项目
    </h1>
    
    <div class="nav-buttons">
        <a href="{{ url_for('home') }}" class="btn"><i class="fas fa-arrow-left"></i> 返回首页</a>
    </div>
    
    <!-- 添加特定类名用于PC端未登录状态 -->
    <div class="project-grid {% if device_type == 'desktop' and not session.admin %}pc-home-grid{% endif %}">
        {% for project in projects %}
            <div class="project-card">
                <!-- 图片部分 -->
                <div class="project-image-container">
                    {% if project.image_path %}
                        <img src="{{ url_for('static', filename=project.thumbnail_path) }}" 
                             data-full="{{ url_for('static', filename=project.image_path) }}"
                             alt="{{ project.title }}"
                             class="project-image">
                    {% else %}
                        <div class="project-image-placeholder">
                            <i class="fas fa-image"></i>
                        </div>
                    {% endif %}
                </div>
                
                <!-- 文字信息部分 -->
                <div class="project-info">
                    <h3 class="project-title">{{ project.title }}</h3>
                    <p class="project-description">
                        {% if project.description %}
                            {{ project.description[:50] }}{% if project.description|length > 50 %}...{% endif %}
                        {% else %}
                            <span style="color: #999; font-style: italic;">暂无描述</span>
                        {% endif %}
                    </p>
                    
                    <div class="project-meta">
                        <span class="status-tag 
                            {% if project.status == '制作中' %}status-making{% endif %}
                            {% if project.status == '排队中' %}status-queued{% endif %}
                            {% if project.status == '已完成' %}status-completed{% endif %}
                        ">
                            {{ project.status }}
                        </span>
                        <span class="project-date">创建时间: {{ project.created_at }}</span>
                    </div>
                    {% if project.status == '已完成' %}
                    <div class="project-completed">
                        <small>完成时间: {{ project.format_completed_date() }}</small>
                    </div>
                    {% endif %}
                </div>
            </div>
        {% else %}
            <p>暂无项目</p>
        {% endfor %}
    </div>

<!-- 分页按钮 -->
<div class="pagination">
    {% if page > 1 %}
        <a href="{{ url_for('show_category', category=category, page=page-1) }}" class="page-btn">上一页</a>
    {% endif %}

    {% for p in range(1, total_pages + 1) %}
        <a href="{{ url_for('show_category', category=category, page=p) }}"
           class="page-btn {% if p == page %}active{% endif %}">
            {{ p }}
        </a>
    {% endfor %}

    {% if page < total_pages %}
        <a href="{{ url_for('show_category', category=category, page=page+1) }}" class="page-btn">下一页</a>
    {% endif %}
</div>

{% endblock %}
